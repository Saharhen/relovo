{% extends "base.html" %}

{% block content %}
<div class="container">
    <h1 class="page-title">{{ _("–û–±—ä—è–≤–ª–µ–Ω–∏—è") }}</h1>

    <div class="filters-wrapper">
        <button class="fbtn" onclick="openFilter('city', this)">üèô {{ _("–ì–æ—Ä–æ–¥") }}</button>
        <button class="fbtn" onclick="openFilter('price', this)">üí∞ {{ _("–¶–µ–Ω–∞") }}</button>
        <button class="fbtn" onclick="openFilter('type', this)">üè† {{ _("–¢–∏–ø –∂–∏–ª—å—è") }}</button>
        <button class="fbtn search-btn" onclick="applyFilters()">üîé {{ _("–ü–æ–∏—Å–∫") }}</button>

        <div id="filter-city" class="filter-popup">
            <label>{{ _("–ì–æ—Ä–æ–¥") }}</label>
            <input type="text" id="city-input" placeholder="{{ _('–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥') }}">
        </div>

        <div id="filter-price" class="filter-popup">
            <label>{{ _("–¶–µ–Ω–∞ –æ—Ç") }}</label>
            <input type="number" id="min-price">
            <label>{{ _("–¶–µ–Ω–∞ –¥–æ") }}</label>
            <input type="number" id="max-price">
        </div>

        <div id="filter-type" class="filter-popup">
            <label>{{ _("–¢–∏–ø –∂–∏–ª—å—è") }}</label>
            <select id="type-select">
                <option value="">{{ _("–õ—é–±–æ–π") }}</option>
                <option value="apartment">{{ _("–ö–≤–∞—Ä—Ç–∏—Ä–∞") }}</option>
                <option value="house">{{ _("–î–æ–º") }}</option>
                <option value="room">{{ _("–ö–æ–º–Ω–∞—Ç–∞") }}</option>
            </select>
        </div>
    </div>

    <div class="relok-grid">
        {% for item in listings %}
        <div class="relok-card">
            <a href="/listing/{{ item.id }}">
                {% if item.image_filenames %}
                    <img src="/static/uploads/{{ item.image_filenames[0] }}" class="relok-img">
                {% else %}
                    <img src="/static/no_image.png" class="relok-img">
                {% endif %}
            </a>

            <div class="relok-info">
                <h3 class="relok-title">{{ item.title }}</h3>

                {% if item.avg_rating %}
                    <div class="relok-rating">
                        ‚≠ê {{ "%.1f"|format(item.avg_rating) }} ({{ item.reviews|length }})
                    </div>
                {% else %}
                    <div class="relok-rating">{{ _("–ù–µ—Ç –æ—Ç–∑—ã–≤–æ–≤") }}</div>
                {% endif %}

                <p class="relok-sub">
                    {{ item.city }} ‚Ä¢ 
                    {% if item.type == "apartment" %}{{ _("–ö–≤–∞—Ä—Ç–∏—Ä–∞") }}{% endif %}
                    {% if item.type == "house" %}{{ _("–î–æ–º") }}{% endif %}
                    {% if item.type == "room" %}{{ _("–ö–æ–º–Ω–∞—Ç–∞") }}{% endif %}
                </p>

                <p class="relok-price">‚Ç¨{{ item.price }}/{{ _("–º–µ—Å") }}</p>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
